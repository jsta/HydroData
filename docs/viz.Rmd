---
pagetitle: HydroData for R
---

```{r echo = FALSE, results='hide', warning=FALSE, message=FALSE}
devtools::load_all()
```

## Visualize Data

`HydroData` offers two functions for visualizing -- and interacting with -- spatial and observation data. These are `explore` and `inspect`. This page walks through these functions and the features available in each.

### Exploring Spatial Data

For this example we will use the `explore` function to interactivly view the NHD river network and availble USGS stations within a 2,500 square mile region centered on Cheyenne Mountain High School in Colorado Springs, Colorado.

To do this, we first define the Area of Interest:

```{r case_study}
case_study =  list("Cheyenne Mountain High School", 50, 50)
```

Next, we query a `HydroData` object for the NHD network and the USGS stations within this AOI:

```{r HydroData Objects, eval = FALSE}
nhd = findNHD(clip_unit = case_study)
usgs = findUSGS(clip_unit = case_study)
```

To get a better sense of the data available in these objects we call the `explore` function. `Explore` generates a leaflet map of the data showing the location, key features, and distirbution of spatial data. Such visualizations can helpful for station disovery, and better understanding an AOI. `Explore` can take either a single `HydroData` object OR a list of `HydroData` objects as input. All inputs will be included in the leaflet map generated.

```{r, eval = FALSE}
explore(input = list(nhd,usgs))
```

Each `explore` map contains a set of features useful for discovery:

The first of these is that each `HydroData` data type has a predefined symbololgy and information set that is relevant to that featrure. Hovering/clicking on each element reveals this information. In the example here, each NHD reach is labeled with it colloquail name (when avaialble) and its COMID which can be used in querying National Water Model results. Each USGS station is indentified by the USGS logo, and displys information relating to it site number, corresponding NHD COMID, and site name. Additonally each ID number is linked to the stations main NWIS page. 

<br>
<br>
<center>
<a ><img alt = '' width='800' src='img/labels.gif' /></a>
</center>
<br>
<br>

Each `explore` map also gives the user the abilty to locate themselves within a larger context via a mini-map in the lower right-hand corner as well as the ability to switch between basemap layers and toggle on and off HydroData object layers:

<br>
<br>
<center>
<a ><img alt = '' width='800' src='img/sidebars.gif' /></a>
</center>
<br>
<br>

Fianlly, via leaflet, explore maps allow users to identify locations via lat/long, and measure distances and areas. These tools are helpful when identifying closest stations, looking to refine an AOI query or when trying to get a better grasp on the spatial properties of a feature set:

<br>
<br>
<center>
<a ><img alt = '' width='800' src='img/measure.gif' /></a>
</center>
<br>
<br>


### Inspecting Temporal Data

`HydroData` was not only designed to collect and visualize spatial data, but also temporal, observation data. If you haven't yet checked out the page on [getting observation data](get_tab.html) I suggest doing so! To help make sense of this observation data `HydroData` offers the `inspect` function. As an example lets say you are interested in the average wind speeds near Denver, Colorado in 2016. We know WeatherUnderground Stations record this data so we can query an airport `HydroData` object for this AOI with appended IDs:

```{r, message=FALSE}
ap = findAirports(clip_unit = list("Denver, CO", 50, 50), ids = T)
ap$ids
```

Doing so reveals the ICOA code for Denver International Airport is 'KDEN'. Using this ID, we can get observation meterologic data using the `getWU()` function and specifing the year of interest as 2016. 

```{r, eval = TRUE, message=FALSE}
met = getWU(IDs = "KDEN", year = 2016)

```

`Inspect` generates a dygraphs, interactive timeseries plot for input data. Such visualizations can be helpful  identifying patterns and selecting years of interest. To run, `inspect` requiers a `HydroData` observation object and a parameter to plot. The parameter entered must match a column name in the input data set. The `names` function can be used to see these:

```{r}
names(met)
```

Of these options we are interest in the average wind speed , "Wind_avg", which can be used for the `param` input for the inspect plot. Running this code will generate an interactive time series plot which contains a set of useful features:

The first is that each inspect plot is autogenerated with the correct axis labels and titles for the selected parameter. Additionally, scrolling over the timeseries reveals the data date and value. Draggin a box over a region of the plot will zoom in to that area for closer inspection:

```{r, eval = F}
inspect(met, param = "Wind_avg")
```

<br>
<br>
<center>
<a ><img alt = '' width='800' src='img/daily.gif' /></a>
</center>
<br>
<br>

Data can be also aggregated to coarser time slices using the `timestep` parameter. For example the daily wind data can be plotted as a monthly values:

```{r, eval = F}
inspect(met, param = "Wind_avg", timestep = "monthly")
```


<br>
<br>
<center>
<a ><img alt = '' width='800' src='img/monthly.gif' /></a>
</center>
<br>
<br>


## Sharing Viualizations

Both `explore` and `inspect` objects can be exported as a raw HTML object using the parameter `save = TRUE`

```{r, eval = F}
inspect(met, param = "Wind_avg", timestep = "monthly", save = TRUE)
```

Doing so, will create a `HydroData` directory within you working directory. In this there will be a sub folder called 'viz' where all `explore` and `inspect` objects will be saved. These are usefult when you wish to share data with others, or reference data interactivly latter on.

To learn more about saveing/export `HydroData` features please see the [Saving&Exporting](save.html) page.
